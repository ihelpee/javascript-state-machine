StateMachine={VERSION:"2.0.0",create:function(a,f){var c=(typeof a.initial=="string")?{state:a.initial}:a.initial;var g=f||a.target||{};var d={};var e=function(i){var k=(i.from instanceof Array)?i.from:[i.from];d[i.name]=d[i.name]||{};for(var j=0;j<k.length;j++){d[i.name][k[j]]=i}};if(c){c.event=c.event||"startup";e({name:c.event,from:"none",to:c.state})}for(var h=0;h<a.events.length;h++){e(a.events[h])}for(var b in d){if(d.hasOwnProperty(b)){g[b]=StateMachine.buildEvent(b,d[b])}}g.current="none";g.is=function(i){return this.current==i};g.can=function(i){return !!d[i][this.current]};g.cannot=function(i){return !this.can(i)};if(c&&!c.defer){g[c.event]()}return g},beforeEvent:function(b,a){var c=this["onbefore"+b];if(c&&(false===c.apply(this,a))){return false}},exitState:function(c,a){var b=this["onleave"+c];if(b){b.apply(this,a)}},enterState:function(c,a){var b=this["onenter"+c]||this["on"+c];if(b){b.apply(this,a)}},changeState:function(d,c,a){var b=this["onchangestate"];if(b){b.apply(this,[d,c].concat(a))}},afterEvent:function(b,a){var c=this["onafter"+b]||this["on"+b];if(c){c.apply(this,a)}},transition:function(c,b,a){this.current=b;StateMachine.enterState.call(this,b,a);StateMachine.changeState.call(this,c,b,a)},buildEvent:function(a,b){return function(){if(this.transition){throw"event "+a+" innapropriate because previous async transition from "+this.transition.from+" to "+this.transition.to+" did not complete"}if(this.cannot(a)){throw"event "+a+" innapropriate in current state "+this.current}var g=this.current;var f=b[g].to;var e=b[g].async;var c=this;var d=Array.prototype.slice.call(arguments);if(StateMachine.beforeEvent.call(this,a,d)===false){return}if(this.current!=f){this.transition=function(){StateMachine.transition.call(c,g,f,d);c.transition=null};this.transition.from=g;this.transition.to=f;StateMachine.exitState.call(this,this.current,arguments);if(!e&&this.transition){this.transition()}}StateMachine.afterEvent.call(this,a,arguments)}}};